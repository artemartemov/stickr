var G=Object.defineProperty,le=Object.defineProperties,pe=Object.getOwnPropertyDescriptor,me=Object.getOwnPropertyDescriptors,de=Object.getOwnPropertyNames,X=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable;var W=(e,t,o)=>t in e?G(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,$=(e,t)=>{for(var o in t||(t={}))K.call(t,o)&&W(e,o,t[o]);if(X)for(var o of X(t))fe.call(t,o)&&W(e,o,t[o]);return e},k=(e,t)=>le(e,me(t));var x=(e,t)=>()=>(e&&(t=e(e=0)),t);var ue=(e,t)=>{for(var o in t)G(e,o,{get:t[o],enumerable:!0})},ge=(e,t,o,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of de(t))!K.call(e,r)&&r!==o&&G(e,r,{get:()=>t[r],enumerable:!(n=pe(t,r))||n.enumerable});return e};var ye=e=>ge(G({},"__esModule",{value:!0}),e);function w(e,t){let o=`${Y}`;return Y+=1,_[o]={handler:t,name:e},function(){delete _[o]}}function Z(e,t){let o=!1;for(let n in _)_[n].name===e&&(_[n].handler.apply(null,t),o=!0);if(o===!1)throw new Error(`No event handler with name \`${e}\``)}var _,Y,h,j=x(()=>{_={},Y=0;h=typeof window=="undefined"?function(e,...t){figma.ui.postMessage([e,...t])}:function(e,...t){window.parent.postMessage({pluginMessage:[e,...t]},"*")};typeof window=="undefined"?figma.ui.onmessage=function(e){if(!Array.isArray(e))return;let[t,...o]=e;typeof t=="string"&&Z(t,o)}:window.onmessage=function(e){if(typeof e.data.pluginMessage=="undefined")return;let t=e.data.pluginMessage;if(!Array.isArray(t))return;let[o,...n]=e.data.pluginMessage;typeof o=="string"&&Z(o,n)}});function V(e,t){if(typeof __html__=="undefined")throw new Error("No UI defined");let o=`<div id="create-figma-plugin"></div><script>document.body.classList.add('theme-${figma.editorType}');const __FIGMA_COMMAND__='${typeof figma.command=="undefined"?"":figma.command}';const __SHOW_UI_DATA__=${JSON.stringify(typeof t=="undefined"?{}:t)};${__html__}</script>`;figma.showUI(o,k($({},e),{themeColors:typeof e.themeColors=="undefined"?!0:e.themeColors}))}var J=x(()=>{});var q=x(()=>{j();J()});var U,g,D,b,u,De,F,v,Q,ee,te=x(()=>{"use strict";U={HEIGHT:840,WIDTH:600},g={LARGE:32,MEDIUM:24,NORMAL:16,SMALL:12,TINY:8},D={SEMI_BOLD:{family:"Inter",style:"Semi Bold"},MEDIUM:{family:"Inter",style:"Medium"},REGULAR:{family:"Inter",style:"Regular"}},b={LARGE:18,MEDIUM:14,SMALL:11,TINY:10},u={LIGHT_BG:{r:.98,g:.98,b:.98},DARK_BG:{r:.18,g:.18,b:.18},WHITE:{r:1,g:1,b:1},TEXT_DARK:{r:.2,g:.2,b:.2},TEXT_MEDIUM_DARK:{r:.3,g:.3,b:.3},TEXT_LIGHT:{r:.5,g:.5,b:.5},TEXT_LIGHTER:{r:.6,g:.6,b:.6},TEXT_LIGHTEST:{r:.8,g:.8,b:.8}},De={light:{primary:u.TEXT_DARK,secondary:u.TEXT_MEDIUM_DARK,tertiary:u.TEXT_LIGHT,bg:u.WHITE,surface:u.WHITE},dark:{primary:u.WHITE,secondary:u.TEXT_LIGHTEST,tertiary:u.TEXT_LIGHTER,bg:u.DARK_BG,surface:u.DARK_BG}},F={SMALL:8},v={ROW_LABEL_WIDTH:100,ROW_LABEL_WIDTH_LARGE:120,SPACER_HEIGHT:1},Q={SELECTION_DELAY_MS:50,PREVIEW_DELAY_MS:100},ee={THUMBNAIL:.5}});function oe(e){let t=String(e).toLowerCase();return t==="true"?!0:t==="false"?!1:e}function ne(e){let t=String(e).toLowerCase();return t==="true"||t==="false"}function z(e){return e.split("#")[0]}function re(e){return new Promise(t=>setTimeout(t,e))}function C(e){var o,n;let t=figma.createFrame();return t.name=e.name,t.layoutMode=e.layoutMode,t.clipsContent=!1,t.primaryAxisSizingMode=(o=e.primaryAxisSizingMode)!=null?o:"AUTO",t.counterAxisSizingMode=(n=e.counterAxisSizingMode)!=null?n:"AUTO",e.itemSpacing!==void 0&&(t.itemSpacing=e.itemSpacing),e.paddingTop!==void 0&&(t.paddingTop=e.paddingTop),e.paddingBottom!==void 0&&(t.paddingBottom=e.paddingBottom),e.paddingLeft!==void 0&&(t.paddingLeft=e.paddingLeft),e.paddingRight!==void 0&&(t.paddingRight=e.paddingRight),e.fills!==void 0&&(t.fills=e.fills),e.cornerRadius!==void 0&&(t.cornerRadius=e.cornerRadius),e.primaryAxisAlignItems!==void 0&&(t.primaryAxisAlignItems=e.primaryAxisAlignItems),e.counterAxisAlignItems!==void 0&&(t.counterAxisAlignItems=e.counterAxisAlignItems),t}function M(){let e=figma.createFrame();return e.clipsContent=!1,e}async function H(e){let t=figma.createText();return await figma.loadFontAsync(e.fontName),t.fontName=e.fontName,t.fontSize=e.fontSize,t.characters=e.characters,t.fills=e.fills,e.textAlignHorizontal!==void 0&&(t.textAlignHorizontal=e.textAlignHorizontal),t}var ae=x(()=>{"use strict"});var se={};ue(se,{default:()=>Ae});function Ae(){V({height:U.HEIGHT,width:U.WIDTH}),w("GENERATE_STICKER_SHEET",async o=>{try{console.log("Generating sticker sheet...",o),await Ee(o),figma.notify("Sticker sheet generated successfully!")}catch(n){console.error("Error:",n),figma.notify("Error generating sticker sheet")}}),w("GENERATE_PREVIEWS",async o=>{try{console.log("Generating previews for",o.combinations.length,"combinations");let n=await Se(o.combinations);h("PREVIEWS_READY",n)}catch(n){console.error("Error generating previews:",n),h("PREVIEWS_ERROR",{error:String(n)})}}),w("SELECT_COMPONENT_BY_NAME",async o=>{try{let n=figma.currentPage.findAll(r=>r.type==="COMPONENT_SET"&&r.name===o);if(n.length>0){figma.currentPage.selection=[n[0]],figma.viewport.scrollAndZoomIntoView([n[0]]),await re(Q.SELECTION_DELAY_MS);let r=e();h("INIT_DATA",r),console.log("Component selected:",o)}else console.log("No component found with name:",o)}catch(n){console.error("Error selecting component:",n)}});function e(){let o=[],n=figma.currentPage.selection;return n.length>0&&(o=n.filter(r=>r.type==="COMPONENT_SET")),o.map(r=>{let a={},i=r.componentPropertyDefinitions||{};Object.keys(i).forEach(m=>{let f=z(m),s=i[m];a[f]||(a[f]={type:s.type,values:[]}),s.type==="VARIANT"&&s.variantOptions?a[f].values=s.variantOptions:s.type==="BOOLEAN"&&(a[f].values=["true","false"])});let d=Object.keys(a).sort((m,f)=>{let s={VARIANT:0,BOOLEAN:1,INSTANCE_SWAP:2,TEXT:3},T=a[m].type,N=a[f].type,E=s[T]!==void 0?s[T]:999,L=s[N]!==void 0?s[N]:999;return E!==L?E-L:m.localeCompare(f)});return{id:r.id,name:r.name,properties:a,propertyOrder:d,variantCount:r.children.length}})}let t=e();h("INIT_DATA",t),figma.on("selectionchange",()=>{let o=e();h("INIT_DATA",o)})}async function Ee(e){let{dataSource:t,selectedCombinations:o,includeLightDark:n,anovaComponentName:r,layoutConfig:a}=e;if(o.length===0){figma.notify("No combinations selected");return}let i=C({name:"Sticker Sheet",layoutMode:"VERTICAL",itemSpacing:g.LARGE,paddingTop:g.LARGE,paddingBottom:g.LARGE,paddingLeft:g.LARGE,paddingRight:g.LARGE,fills:[{type:"SOLID",color:u.LIGHT_BG}],cornerRadius:F.SMALL}),d={};for(let m of o)d[m.componentSetId]||(d[m.componentSetId]=[]),d[m.componentSetId].push(m);for(let m in d){let f=d[m],s=null,T="";if(t==="anova"){let I=figma.currentPage.selection.find(c=>c.type==="COMPONENT_SET");if(!I){figma.notify("Please select a component set on the canvas to generate from Anova data");return}s=I,T=r||s.name}else{if(s=figma.getNodeById(m),!s)continue;T=s.name}if(!s)continue;let N=await H({fontName:D.SEMI_BOLD,fontSize:b.LARGE,characters:T,fills:[{type:"SOLID",color:u.TEXT_DARK}]});i.appendChild(N);let E=C({name:"Modes Container",layoutMode:"HORIZONTAL",itemSpacing:g.LARGE,fills:[]}),L=await ie(s,f,!1,a);if(E.appendChild(L),n){let R=await ie(s,f,!0,a);E.appendChild(R);let I=s.resolvedVariableModes;for(let c in I)try{let l=figma.variables.getVariableCollectionById(c);if(l&&l.name.toLowerCase().includes("semantic")){let p=l.modes.find(A=>A.name.toLowerCase().includes("dark"));if(p){R.setExplicitVariableModeForCollection(l,p.modeId),figma.notify("\u2705 Dark mode applied to "+T);break}}}catch(l){console.log("Could not get collection:",c,l)}}i.appendChild(E)}figma.currentPage.selection=[i],figma.viewport.scrollAndZoomIntoView([i])}function Te(e){if(e.length===0)return[];let t={},o={},n=e[0];for(let a of e)for(let i in a.properties)t[i]||(t[i]=new Set),t[i].add(a.properties[i]);let r=[];for(let a in t)if(t[a].size>1){let i=Array.from(t[a]),d="OTHER";i.every(m=>ne(m))?d="BOOLEAN":d="VARIANT",r.push({name:a,values:i,type:d})}return r.sort((a,i)=>a.type==="VARIANT"&&i.type!=="VARIANT"?-1:a.type!=="VARIANT"&&i.type==="VARIANT"?1:a.name.localeCompare(i.name)),r}async function P(e,t){let n=e.children[0].createInstance(),r=e.componentPropertyDefinitions,a={};for(let i in r){let d=z(i);a[d]=i}for(let i in t){let d=t[i],m=a[i];if(m)try{let f=oe(d);n.setProperties({[m]:f})}catch(f){}}return n}async function ie(e,t,o,n){let r=C({name:o?"Dark Mode":"Light Mode",layoutMode:"VERTICAL",itemSpacing:g.NORMAL,paddingTop:g.MEDIUM,paddingBottom:g.MEDIUM,paddingLeft:g.MEDIUM,paddingRight:g.MEDIUM,cornerRadius:F.SMALL,fills:o?[{type:"SOLID",color:u.DARK_BG}]:[{type:"SOLID",color:u.WHITE}]}),a=await H({fontName:D.MEDIUM,fontSize:b.MEDIUM,characters:o?"Dark Mode":"Light Mode",fills:o?[{type:"SOLID",color:u.WHITE}]:[{type:"SOLID",color:u.TEXT_DARK}]});r.appendChild(a);let i=await Ie(e,t,o,n);return r.appendChild(i),r}async function Ie(e,t,o,n){let r=C({name:"Table",layoutMode:"VERTICAL",itemSpacing:g.TINY,fills:[]});if(t.length===0)return r;let a=await P(e,t[0].properties),i=a.width,d=a.height;a.remove();let m=Te(t);if(m.length===0){let c=C({name:"Row",layoutMode:"HORIZONTAL",itemSpacing:g.SMALL,fills:[]});for(let l of t){let p=await P(e,l.properties);c.appendChild(p)}return r.appendChild(c),r}let f,s;n&&n.rowProperty&&n.columnProperties&&n.columnProperties.length>0?(f=m.find(c=>c.name===n.rowProperty),s=n.columnProperties.map(c=>m.find(l=>l.name===c)).filter(c=>c!==void 0),(!f||s.length===0)&&(f=m[0],s=m.slice(1))):(f=m[0],s=m.slice(1));let T=[],N=new Set;for(let c of t){let l=String(c.properties[f.name]);N.has(l)||(N.add(l),T.push(l))}let E=[],L=new Set;for(let c of t){let l={};for(let A of s)l[A.name]=c.properties[A.name];let p=JSON.stringify(l);L.has(p)||(L.add(p),E.push(l))}E.sort((c,l)=>{for(let p of s){let A=String(c[p.name]),S=String(l[p.name]);if(A!==S)return A.localeCompare(S)}return 0});let R=C({name:"Header Row",layoutMode:"HORIZONTAL",itemSpacing:g.SMALL,paddingBottom:g.TINY,fills:[]}),I=M();I.resize(v.ROW_LABEL_WIDTH,v.SPACER_HEIGHT),I.fills=[],R.appendChild(I);for(let c=0;c<E.length;c++){let l=E[c],p=M();p.layoutMode="VERTICAL",p.primaryAxisSizingMode="FIXED",p.counterAxisSizingMode="AUTO",p.primaryAxisAlignItems="CENTER",p.fills=[];let A=[];if(s.length>0)for(let O of s){let y=String(l[O.name]);A.push(`${O.name}: (${c+1}) ${y}`)}else A.push(`(${c+1})`);let S=await H({fontName:D.SEMI_BOLD,fontSize:b.TINY,characters:A.join(`
`),fills:o?[{type:"SOLID",color:u.TEXT_LIGHTER}]:[{type:"SOLID",color:u.TEXT_LIGHT}],textAlignHorizontal:"CENTER"});p.appendChild(S),p.resize(Math.max(i,S.width+g.TINY),S.height+g.TINY),R.appendChild(p)}r.appendChild(R);for(let c of T){let l=C({name:`Row: ${c}`,layoutMode:"HORIZONTAL",itemSpacing:g.SMALL,fills:[]}),p=M();p.resize(v.ROW_LABEL_WIDTH,d),p.layoutMode="VERTICAL",p.primaryAxisAlignItems="CENTER",p.counterAxisAlignItems="CENTER",p.fills=[];let A=await H({fontName:D.REGULAR,fontSize:b.SMALL,characters:`${f.name}:
${c}`,fills:o?[{type:"SOLID",color:u.TEXT_LIGHTEST}]:[{type:"SOLID",color:u.TEXT_MEDIUM_DARK}],textAlignHorizontal:"CENTER"});p.appendChild(A),l.appendChild(p);for(let S of E){let O=t.find(y=>{if(String(y.properties[f.name])!==c)return!1;for(let B of s)if(String(y.properties[B.name])!==String(S[B.name]))return!1;return!0});if(O){let y=M();y.resize(i,d),y.layoutMode="VERTICAL",y.primaryAxisAlignItems="CENTER",y.counterAxisAlignItems="CENTER",y.fills=[];let B=await P(e,O.properties);y.appendChild(B),l.appendChild(y)}else{let y=M();y.resize(i,d),y.fills=[],l.appendChild(y)}}r.appendChild(l)}return r}async function Se(e){let t=figma.currentPage.selection;console.log("Current selection:",t.length,"nodes");let o=t.find(r=>r.type==="COMPONENT_SET");if(!o)throw console.error("No component set in selection. Selection:",t.map(r=>({type:r.type,name:r.name}))),new Error("No component set selected");console.log("Using component set:",o.name);let n={};for(let r of e)try{let a=await P(o,r.properties),i=await a.exportAsync({format:"PNG",constraint:{type:"SCALE",value:ee.THUMBNAIL}}),d=figma.base64Encode(i);n[r.variantName]=d,a.remove()}catch(a){console.error("Error generating preview for",r.variantName,a)}return console.log("Generated",Object.keys(n).length,"previews out of",e.length,"combinations"),n}var ce=x(()=>{"use strict";q();te();ae()});var Ce={"src/main.ts--default":(ce(),ye(se)).default},Ne="src/main.ts--default";Ce[Ne]();
