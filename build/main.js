var b=Object.defineProperty,oe=Object.defineProperties,te=Object.getOwnPropertyDescriptor,ne=Object.getOwnPropertyDescriptors,re=Object.getOwnPropertyNames,F=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var V=(o,e,n)=>e in o?b(o,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[e]=n,z=(o,e)=>{for(var n in e||(e={}))P.call(e,n)&&V(o,n,e[n]);if(F)for(var n of F(e))ae.call(e,n)&&V(o,n,e[n]);return o},W=(o,e)=>oe(o,ne(e));var O=(o,e)=>()=>(o&&(e=o(o=0)),e);var ie=(o,e)=>{for(var n in e)b(o,n,{get:e[n],enumerable:!0})},se=(o,e,n,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of re(e))!P.call(o,t)&&t!==n&&b(o,t,{get:()=>e[t],enumerable:!(a=te(e,t))||a.enumerable});return o};var ce=o=>se(b({},"__esModule",{value:!0}),o);function _(o,e){let n=`${X}`;return X+=1,x[n]={handler:e,name:o},function(){delete x[n]}}function K(o,e){let n=!1;for(let a in x)x[a].name===o&&(x[a].handler.apply(null,e),n=!0);if(n===!1)throw new Error(`No event handler with name \`${o}\``)}var x,X,M,$=O(()=>{x={},X=0;M=typeof window=="undefined"?function(o,...e){figma.ui.postMessage([o,...e])}:function(o,...e){window.parent.postMessage({pluginMessage:[o,...e]},"*")};typeof window=="undefined"?figma.ui.onmessage=function(o){if(!Array.isArray(o))return;let[e,...n]=o;typeof e=="string"&&K(e,n)}:window.onmessage=function(o){if(typeof o.data.pluginMessage=="undefined")return;let e=o.data.pluginMessage;if(!Array.isArray(e))return;let[n,...a]=o.data.pluginMessage;typeof n=="string"&&K(n,a)}});function U(o,e){if(typeof __html__=="undefined")throw new Error("No UI defined");let n=`<div id="create-figma-plugin"></div><script>document.body.classList.add('theme-${figma.editorType}');const __FIGMA_COMMAND__='${typeof figma.command=="undefined"?"":figma.command}';const __SHOW_UI_DATA__=${JSON.stringify(typeof e=="undefined"?{}:e)};${__html__}</script>`;figma.showUI(n,W(z({},o),{themeColors:typeof o.themeColors=="undefined"?!0:o.themeColors}))}var k=O(()=>{});var Y=O(()=>{$();k()});var B,A,C,w,u,Ne,v,H,Z,j,J=O(()=>{"use strict";B={HEIGHT:840,WIDTH:600},A={LARGE:32,MEDIUM:24,NORMAL:16,SMALL:12,TINY:8},C={SEMI_BOLD:{family:"Inter",style:"Semi Bold"},MEDIUM:{family:"Inter",style:"Medium"},REGULAR:{family:"Inter",style:"Regular"}},w={LARGE:18,MEDIUM:14,SMALL:11,TINY:10},u={LIGHT_BG:{r:.98,g:.98,b:.98},DARK_BG:{r:.18,g:.18,b:.18},WHITE:{r:1,g:1,b:1},TEXT_DARK:{r:.2,g:.2,b:.2},TEXT_MEDIUM_DARK:{r:.3,g:.3,b:.3},TEXT_LIGHT:{r:.5,g:.5,b:.5},TEXT_LIGHTER:{r:.6,g:.6,b:.6},TEXT_LIGHTEST:{r:.8,g:.8,b:.8}},Ne={light:{primary:u.TEXT_DARK,secondary:u.TEXT_MEDIUM_DARK,tertiary:u.TEXT_LIGHT,bg:u.WHITE,surface:u.WHITE},dark:{primary:u.WHITE,secondary:u.TEXT_LIGHTEST,tertiary:u.TEXT_LIGHTER,bg:u.DARK_BG,surface:u.DARK_BG}},v={SMALL:8},H={ROW_LABEL_WIDTH:100,ROW_LABEL_WIDTH_LARGE:120,SPACER_HEIGHT:1},Z={SELECTION_DELAY_MS:50,PREVIEW_DELAY_MS:100},j={THUMBNAIL:.5}});var Q={};ie(Q,{default:()=>le});function le(){U({height:B.HEIGHT,width:B.WIDTH}),_("GENERATE_STICKER_SHEET",async n=>{try{console.log("Generating sticker sheet...",n),await me(n),figma.notify("Sticker sheet generated successfully!")}catch(a){console.error("Error:",a),figma.notify("Error generating sticker sheet")}}),_("GENERATE_PREVIEWS",async n=>{try{console.log("Generating previews for",n.combinations.length,"combinations");let a=await de(n.combinations);M("PREVIEWS_READY",a)}catch(a){console.error("Error generating previews:",a),M("PREVIEWS_ERROR",{error:String(a)})}}),_("SELECT_COMPONENT_BY_NAME",async n=>{try{let a=figma.currentPage.findAll(t=>t.type==="COMPONENT_SET"&&t.name===n);if(a.length>0){figma.currentPage.selection=[a[0]],figma.viewport.scrollAndZoomIntoView([a[0]]),await new Promise(i=>setTimeout(i,Z.SELECTION_DELAY_MS));let t=o();M("INIT_DATA",t),console.log("Component selected:",n)}else console.log("No component found with name:",n)}catch(a){console.error("Error selecting component:",a)}});function o(){let n=[],a=figma.currentPage.selection;return a.length>0&&(n=a.filter(t=>t.type==="COMPONENT_SET")),n.map(t=>{let i={},r=t.componentPropertyDefinitions||{};Object.keys(r).forEach(m=>{let d=m.split("#")[0],l=r[m];i[d]||(i[d]={type:l.type,values:[]}),l.type==="VARIANT"&&l.variantOptions?i[d].values=l.variantOptions:l.type==="BOOLEAN"&&(i[d].values=["true","false"])});let f=Object.keys(i).sort((m,d)=>{let l={VARIANT:0,BOOLEAN:1,INSTANCE_SWAP:2,TEXT:3},S=i[m].type,I=i[d].type,E=l[S]!==void 0?l[S]:999,h=l[I]!==void 0?l[I]:999;return E!==h?E-h:m.localeCompare(d)});return{id:t.id,name:t.name,properties:i,propertyOrder:f,variantCount:t.children.length}})}let e=o();M("INIT_DATA",e),figma.on("selectionchange",()=>{let n=o();M("INIT_DATA",n)})}async function me(o){let{dataSource:e,selectedCombinations:n,includeLightDark:a,anovaComponentName:t,layoutConfig:i}=o;if(n.length===0){figma.notify("No combinations selected");return}let r=figma.createFrame();r.name="Sticker Sheet",r.layoutMode="VERTICAL",r.primaryAxisSizingMode="AUTO",r.counterAxisSizingMode="AUTO",r.itemSpacing=A.LARGE,r.paddingTop=A.LARGE,r.paddingBottom=A.LARGE,r.paddingLeft=A.LARGE,r.paddingRight=A.LARGE,r.fills=[{type:"SOLID",color:u.LIGHT_BG}],r.cornerRadius=v.SMALL;let f={};for(let m of n)f[m.componentSetId]||(f[m.componentSetId]=[]),f[m.componentSetId].push(m);for(let m in f){let d=f[m],l=null,S="";if(e==="anova"){let L=figma.currentPage.selection.find(s=>s.type==="COMPONENT_SET");if(!L){figma.notify("Please select a component set on the canvas to generate from Anova data");return}l=L,S=t||l.name}else{if(l=figma.getNodeById(m),!l)continue;S=l.name}if(!l)continue;let I=figma.createText();await figma.loadFontAsync(C.SEMI_BOLD),I.fontName=C.SEMI_BOLD,I.fontSize=w.LARGE,I.characters=S,I.fills=[{type:"SOLID",color:u.TEXT_DARK}],r.appendChild(I);let E=figma.createFrame();E.name="Modes Container",E.layoutMode="HORIZONTAL",E.primaryAxisSizingMode="AUTO",E.counterAxisSizingMode="AUTO",E.itemSpacing=A.LARGE,E.fills=[];let h=await q(l,d,!1,i);if(E.appendChild(h),a){let y=await q(l,d,!0,i);E.appendChild(y);let L=l.resolvedVariableModes;for(let s in L)try{let c=figma.variables.getVariableCollectionById(s);if(c&&c.name.toLowerCase().includes("semantic")){let p=c.modes.find(g=>g.name.toLowerCase().includes("dark"));if(p){y.setExplicitVariableModeForCollection(c,p.modeId),figma.notify("\u2705 Dark mode applied to "+S);break}}}catch(c){console.log("Could not get collection:",s,c)}}r.appendChild(E)}figma.currentPage.selection=[r],figma.viewport.scrollAndZoomIntoView([r])}function pe(o){if(o.length===0)return[];let e={},n={},a=o[0];for(let i of o)for(let r in i.properties)e[r]||(e[r]=new Set),e[r].add(i.properties[r]);let t=[];for(let i in e)if(e[i].size>1){let r=Array.from(e[i]),f="OTHER";r.every(m=>String(m).toLowerCase()==="true"||String(m).toLowerCase()==="false")?f="BOOLEAN":f="VARIANT",t.push({name:i,values:r,type:f})}return t.sort((i,r)=>i.type==="VARIANT"&&r.type!=="VARIANT"?-1:i.type!=="VARIANT"&&r.type==="VARIANT"?1:i.name.localeCompare(r.name)),t}async function G(o,e){let a=o.children[0].createInstance(),t=o.componentPropertyDefinitions,i={};for(let r in t){let f=r.split("#")[0];i[f]=r}for(let r in e){let f=e[r],m=i[r];if(m)try{let d=f;String(f).toLowerCase()==="true"?d=!0:String(f).toLowerCase()==="false"&&(d=!1),a.setProperties({[m]:d})}catch(d){}}return a}async function q(o,e,n,a){let t=figma.createFrame();t.name=n?"Dark Mode":"Light Mode",t.layoutMode="VERTICAL",t.primaryAxisSizingMode="AUTO",t.counterAxisSizingMode="AUTO",t.itemSpacing=A.NORMAL,t.paddingTop=A.MEDIUM,t.paddingBottom=A.MEDIUM,t.paddingLeft=A.MEDIUM,t.paddingRight=A.MEDIUM,t.cornerRadius=v.SMALL,t.fills=n?[{type:"SOLID",color:u.DARK_BG}]:[{type:"SOLID",color:u.WHITE}];let i=figma.createText();await figma.loadFontAsync(C.MEDIUM),i.fontName=C.MEDIUM,i.fontSize=w.MEDIUM,i.characters=n?"Dark Mode":"Light Mode",i.fills=n?[{type:"SOLID",color:u.WHITE}]:[{type:"SOLID",color:u.TEXT_DARK}],t.appendChild(i);let r=await fe(o,e,n,a);return t.appendChild(r),t}async function fe(o,e,n,a){let t=figma.createFrame();if(t.name="Table",t.layoutMode="VERTICAL",t.primaryAxisSizingMode="AUTO",t.counterAxisSizingMode="AUTO",t.itemSpacing=A.TINY,t.fills=[],e.length===0)return t;let i=await G(o,e[0].properties),r=i.width,f=i.height;i.remove(),await figma.loadFontAsync(C.SEMI_BOLD),await figma.loadFontAsync(C.REGULAR);let m=pe(e);if(m.length===0){let s=figma.createFrame();s.layoutMode="HORIZONTAL",s.itemSpacing=A.SMALL,s.fills=[];for(let c of e){let p=await G(o,c.properties);s.appendChild(p)}return t.appendChild(s),t}let d,l;a&&a.rowProperty&&a.columnProperties&&a.columnProperties.length>0?(d=m.find(s=>s.name===a.rowProperty),l=a.columnProperties.map(s=>m.find(c=>c.name===s)).filter(s=>s!==void 0),(!d||l.length===0)&&(d=m[0],l=m.slice(1))):(d=m[0],l=m.slice(1));let S=[],I=new Set;for(let s of e){let c=String(s.properties[d.name]);I.has(c)||(I.add(c),S.push(c))}let E=[],h=new Set;for(let s of e){let c={};for(let g of l)c[g.name]=s.properties[g.name];let p=JSON.stringify(c);h.has(p)||(h.add(p),E.push(c))}E.sort((s,c)=>{for(let p of l){let g=String(s[p.name]),N=String(c[p.name]);if(g!==N)return g.localeCompare(N)}return 0});let y=figma.createFrame();y.name="Header Row",y.layoutMode="HORIZONTAL",y.itemSpacing=A.SMALL,y.fills=[],y.paddingBottom=A.TINY;let L=figma.createFrame();L.resize(H.ROW_LABEL_WIDTH,H.SPACER_HEIGHT),L.fills=[],y.appendChild(L);for(let s=0;s<E.length;s++){let c=E[s],p=figma.createFrame();p.layoutMode="VERTICAL",p.primaryAxisSizingMode="FIXED",p.counterAxisSizingMode="AUTO",p.primaryAxisAlignItems="CENTER",p.fills=[];let g=figma.createText();g.fontName=C.SEMI_BOLD,g.fontSize=w.TINY,g.textAlignHorizontal="CENTER";let N=[];if(l.length>0)for(let R of l){let T=String(c[R.name]);N.push(`${R.name}: (${s+1}) ${T}`)}else N.push(`(${s+1})`);g.characters=N.join(`
`),g.fills=n?[{type:"SOLID",color:u.TEXT_LIGHTER}]:[{type:"SOLID",color:u.TEXT_LIGHT}],p.appendChild(g),p.resize(Math.max(r,g.width+A.TINY),g.height+A.TINY),y.appendChild(p)}t.appendChild(y);for(let s of S){let c=figma.createFrame();c.name=`Row: ${s}`,c.layoutMode="HORIZONTAL",c.itemSpacing=A.SMALL,c.fills=[];let p=figma.createFrame();p.resize(H.ROW_LABEL_WIDTH,f),p.layoutMode="VERTICAL",p.primaryAxisAlignItems="CENTER",p.counterAxisAlignItems="CENTER",p.fills=[];let g=figma.createText();g.fontName=C.REGULAR,g.fontSize=w.SMALL,g.characters=`${d.name}:
${s}`,g.textAlignHorizontal="CENTER",g.fills=n?[{type:"SOLID",color:u.TEXT_LIGHTEST}]:[{type:"SOLID",color:u.TEXT_MEDIUM_DARK}],p.appendChild(g),c.appendChild(p);for(let N of E){let R=e.find(T=>{if(String(T.properties[d.name])!==s)return!1;for(let D of l)if(String(T.properties[D.name])!==String(N[D.name]))return!1;return!0});if(R){let T=figma.createFrame();T.resize(r,f),T.layoutMode="VERTICAL",T.primaryAxisAlignItems="CENTER",T.counterAxisAlignItems="CENTER",T.fills=[];let D=await G(o,R.properties);T.appendChild(D),c.appendChild(T)}else{let T=figma.createFrame();T.resize(r,f),T.fills=[],c.appendChild(T)}}t.appendChild(c)}return t}async function de(o){let e=figma.currentPage.selection;console.log("Current selection:",e.length,"nodes");let n=e.find(t=>t.type==="COMPONENT_SET");if(!n)throw console.error("No component set in selection. Selection:",e.map(t=>({type:t.type,name:t.name}))),new Error("No component set selected");console.log("Using component set:",n.name);let a={};for(let t of o)try{let i=await G(n,t.properties),r=await i.exportAsync({format:"PNG",constraint:{type:"SCALE",value:j.THUMBNAIL}}),f=figma.base64Encode(r);a[t.variantName]=f,i.remove()}catch(i){console.error("Error generating preview for",t.variantName,i)}return console.log("Generated",Object.keys(a).length,"previews out of",o.length,"combinations"),a}var ee=O(()=>{"use strict";Y();J()});var ge={"src/main.ts--default":(ee(),ce(Q)).default},ue="src/main.ts--default";ge[ue]();
