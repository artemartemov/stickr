var w=Object.defineProperty,W=Object.defineProperties,G=Object.getOwnPropertyDescriptor,j=Object.getOwnPropertyDescriptors,Z=Object.getOwnPropertyNames,L=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var v=(o,e,t)=>e in o?w(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,z=(o,e)=>{for(var t in e||(e={}))F.call(e,t)&&v(o,t,e[t]);if(L)for(var t of L(e))X.call(e,t)&&v(o,t,e[t]);return o},V=(o,e)=>W(o,j(e));var O=(o,e)=>()=>(o&&(e=o(o=0)),e);var K=(o,e)=>{for(var t in e)w(o,t,{get:e[t],enumerable:!0})},J=(o,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of Z(e))!F.call(o,a)&&a!==t&&w(o,a,{get:()=>e[a],enumerable:!(n=G(e,a))||n.enumerable});return o};var q=o=>J(w({},"__esModule",{value:!0}),o);function R(o,e){let t=`${D}`;return D+=1,T[t]={handler:e,name:o},function(){delete T[t]}}function _(o,e){let t=!1;for(let n in T)T[n].name===o&&(T[n].handler.apply(null,e),t=!0);if(t===!1)throw new Error(`No event handler with name \`${o}\``)}var T,D,I,B=O(()=>{T={},D=0;I=typeof window=="undefined"?function(o,...e){figma.ui.postMessage([o,...e])}:function(o,...e){window.parent.postMessage({pluginMessage:[o,...e]},"*")};typeof window=="undefined"?figma.ui.onmessage=function(o){if(!Array.isArray(o))return;let[e,...t]=o;typeof e=="string"&&_(e,t)}:window.onmessage=function(o){if(typeof o.data.pluginMessage=="undefined")return;let e=o.data.pluginMessage;if(!Array.isArray(e))return;let[t,...n]=o.data.pluginMessage;typeof t=="string"&&_(t,n)}});function M(o,e){if(typeof __html__=="undefined")throw new Error("No UI defined");let t=`<div id="create-figma-plugin"></div><script>document.body.classList.add('theme-${figma.editorType}');const __FIGMA_COMMAND__='${typeof figma.command=="undefined"?"":figma.command}';const __SHOW_UI_DATA__=${JSON.stringify(typeof e=="undefined"?{}:e)};${__html__}</script>`;figma.showUI(t,V(z({},o),{themeColors:typeof o.themeColors=="undefined"?!0:o.themeColors}))}var U=O(()=>{});var P=O(()=>{B();U()});var $={};K($,{default:()=>Y});function Y(){M({height:720,width:480}),R("GENERATE_STICKER_SHEET",async t=>{try{console.log("Generating sticker sheet...",t),await Q(t),figma.notify("Sticker sheet generated successfully!")}catch(n){console.error("Error:",n),figma.notify("Error generating sticker sheet")}}),R("GENERATE_PREVIEWS",async t=>{try{console.log("Generating previews for",t.combinations.length,"combinations");let n=await te(t.combinations);I("PREVIEWS_READY",n)}catch(n){console.error("Error generating previews:",n),I("PREVIEWS_ERROR",{error:String(n)})}});function o(){let t=[],n=figma.currentPage.selection;return n.length>0&&(t=n.filter(a=>a.type==="COMPONENT_SET")),t.map(a=>{let r={},i=a.componentPropertyDefinitions||{};Object.keys(i).forEach(d=>{let c=d.split("#")[0],g=i[d];r[c]||(r[c]={type:g.type,values:[]}),g.type==="VARIANT"&&g.variantOptions?r[c].values=g.variantOptions:g.type==="BOOLEAN"&&(r[c].values=["true","false"])});let l=Object.keys(r).sort((d,c)=>{let g={VARIANT:0,BOOLEAN:1,INSTANCE_SWAP:2,TEXT:3},C=r[d].type,A=r[c].type,y=g[C]!==void 0?g[C]:999,h=g[A]!==void 0?g[A]:999;return y!==h?y-h:d.localeCompare(c)});return{id:a.id,name:a.name,properties:r,propertyOrder:l,variantCount:a.children.length}})}let e=o();I("INIT_DATA",e),figma.on("selectionchange",()=>{let t=o();I("INIT_DATA",t)})}async function Q(o){let{dataSource:e,selectedCombinations:t,includeLightDark:n,anovaComponentName:a}=o;if(t.length===0){figma.notify("No combinations selected");return}let r=figma.createFrame();r.name="Sticker Sheet",r.layoutMode="VERTICAL",r.primaryAxisSizingMode="AUTO",r.counterAxisSizingMode="AUTO",r.itemSpacing=0,r.paddingTop=32,r.paddingBottom=32,r.paddingLeft=32,r.paddingRight=32,r.fills=[{type:"SOLID",color:{r:.98,g:.98,b:.98}}],r.cornerRadius=8;let i={};for(let l of t)i[l.componentSetId]||(i[l.componentSetId]=[]),i[l.componentSetId].push(l);for(let l in i){let d=i[l],c=null,g="";if(e==="anova"){let p=figma.currentPage.selection.find(m=>m.type==="COMPONENT_SET");if(!p){figma.notify("Please select a component set on the canvas to generate from Anova data");return}c=p,g=a||c.name}else{if(c=figma.getNodeById(l),!c)continue;g=c.name}if(!c)continue;let C=figma.createText();await figma.loadFontAsync({family:"Inter",style:"Semi Bold"}),C.fontName={family:"Inter",style:"Semi Bold"},C.fontSize=18,C.characters=g,C.fills=[{type:"SOLID",color:{r:.2,g:.2,b:.2}}],r.appendChild(C);let A=figma.createFrame();A.resize(1,16),A.fills=[],r.appendChild(A);let y=figma.createFrame();y.name="Modes Container",y.layoutMode="HORIZONTAL",y.primaryAxisSizingMode="AUTO",y.counterAxisSizingMode="AUTO",y.itemSpacing=24,y.fills=[];let h=await H(c,d,!1);if(y.appendChild(h),n){let s=await H(c,d,!0);y.appendChild(s)}r.appendChild(y);let x=figma.createFrame();x.resize(1,24),x.fills=[],r.appendChild(x)}figma.currentPage.selection=[r],figma.viewport.scrollAndZoomIntoView([r])}function ee(o){if(o.length===0)return[];let e={},t={},n=o[0];for(let r of o)for(let i in r.properties)e[i]||(e[i]=new Set),e[i].add(r.properties[i]);let a=[];for(let r in e)if(e[r].size>1){let i=Array.from(e[r]),l="OTHER";i.every(d=>String(d).toLowerCase()==="true"||String(d).toLowerCase()==="false")?l="BOOLEAN":l="VARIANT",a.push({name:r,values:i,type:l})}return a.sort((r,i)=>r.type==="VARIANT"&&i.type!=="VARIANT"?-1:r.type!=="VARIANT"&&i.type==="VARIANT"?1:r.name.localeCompare(i.name)),a}async function b(o,e){let n=o.children[0].createInstance(),a=o.componentPropertyDefinitions,r={};for(let i in a){let l=i.split("#")[0];r[l]=i}for(let i in e){let l=e[i],d=r[i];if(d)try{let c=l;String(l).toLowerCase()==="true"?c=!0:String(l).toLowerCase()==="false"&&(c=!1),n.setProperties({[d]:c}),console.log("\u2713 Set property:",i,"=",c)}catch(c){console.log("\u2717 Could not set property:",i,"=",l,"Error:",c)}else console.log("\u2717 No matching key found for property:",i,"Available keys:",Object.keys(r))}return n}async function H(o,e,t){let n=figma.createFrame();n.name=t?"Dark Mode":"Light Mode",n.layoutMode="VERTICAL",n.primaryAxisSizingMode="AUTO",n.counterAxisSizingMode="AUTO",n.itemSpacing=16,n.paddingTop=24,n.paddingBottom=24,n.paddingLeft=24,n.paddingRight=24,n.cornerRadius=8,n.fills=t?[{type:"SOLID",color:{r:.18,g:.18,b:.18}}]:[{type:"SOLID",color:{r:1,g:1,b:1}}];let a=figma.createText();await figma.loadFontAsync({family:"Inter",style:"Medium"}),a.fontName={family:"Inter",style:"Medium"},a.fontSize=14,a.characters=t?"Dark Mode":"Light Mode",a.fills=t?[{type:"SOLID",color:{r:1,g:1,b:1}}]:[{type:"SOLID",color:{r:.2,g:.2,b:.2}}],n.appendChild(a);let r=await oe(o,e,t);return n.appendChild(r),n}async function oe(o,e,t){let n=figma.createFrame();if(n.name="Table",n.layoutMode="VERTICAL",n.primaryAxisSizingMode="AUTO",n.counterAxisSizingMode="AUTO",n.itemSpacing=8,n.fills=[],e.length===0)return n;console.log("=== createSimpleTable DEBUG ==="),console.log("Number of combinations:",e.length),console.log("First combination:",e[0]),console.log("All combinations:",e.map(s=>s.properties));let a=await b(o,e[0].properties),r=a.width,i=a.height;a.remove(),await figma.loadFontAsync({family:"Inter",style:"Semi Bold"}),await figma.loadFontAsync({family:"Inter",style:"Regular"});let l=ee(e);if(console.log("Varying properties found:",l),console.log("Property types:",l.map(s=>({name:s.name,type:s.type,values:s.values}))),l.length===0){let s=figma.createFrame();s.layoutMode="HORIZONTAL",s.itemSpacing=12,s.fills=[];for(let p of e){let m=await b(o,p.properties);s.appendChild(m)}return n.appendChild(s),n}let d=l[0],c=l.slice(1);console.log("Row property:",d),console.log("Column properties:",c);let g=[],C=new Set;for(let s of e){let p=String(s.properties[d.name]);C.has(p)||(C.add(p),g.push(p))}let A=[],y=new Set;for(let s of e){let p={};for(let f of c)p[f.name]=s.properties[f.name];let m=JSON.stringify(p);y.has(m)||(y.add(m),A.push(p))}A.sort((s,p)=>{for(let m of c){let f=String(s[m.name]),S=String(p[m.name]);if(f!==S)return f.localeCompare(S)}return 0}),console.log("Column combinations:",A),console.log("Number of columns:",A.length);let h=figma.createFrame();h.name="Header Row",h.layoutMode="HORIZONTAL",h.itemSpacing=12,h.fills=[],h.paddingBottom=8;let x=figma.createFrame();x.resize(100,1),x.fills=[],h.appendChild(x);for(let s=0;s<A.length;s++){let p=A[s],m=figma.createFrame();m.layoutMode="VERTICAL",m.primaryAxisSizingMode="FIXED",m.counterAxisSizingMode="AUTO",m.primaryAxisAlignItems="CENTER",m.fills=[];let f=figma.createText();f.fontName={family:"Inter",style:"Semi Bold"},f.fontSize=10,f.textAlignHorizontal="CENTER";let S=[];if(c.length>0)for(let N of c){let u=String(p[N.name]);S.push(`${N.name}: (${s+1}) ${u}`)}else S.push(`(${s+1})`);f.characters=S.join(`
`),f.fills=t?[{type:"SOLID",color:{r:.6,g:.6,b:.6}}]:[{type:"SOLID",color:{r:.5,g:.5,b:.5}}],m.appendChild(f),m.resize(Math.max(r,f.width+8),f.height+8),console.log(`Header ${s}: "${f.characters}" - size: ${m.width}x${m.height}`),h.appendChild(m)}n.appendChild(h);for(let s of g){let p=figma.createFrame();p.name=`Row: ${s}`,p.layoutMode="HORIZONTAL",p.itemSpacing=12,p.fills=[];let m=figma.createFrame();m.resize(100,i),m.layoutMode="VERTICAL",m.primaryAxisAlignItems="CENTER",m.counterAxisAlignItems="CENTER",m.fills=[];let f=figma.createText();f.fontName={family:"Inter",style:"Regular"},f.fontSize=11,f.characters=`${d.name}:
${s}`,f.textAlignHorizontal="CENTER",f.fills=t?[{type:"SOLID",color:{r:.8,g:.8,b:.8}}]:[{type:"SOLID",color:{r:.3,g:.3,b:.3}}],m.appendChild(f),p.appendChild(m);for(let S of A){let N=e.find(u=>{if(String(u.properties[d.name])!==s)return!1;for(let E of c)if(String(u.properties[E.name])!==String(S[E.name]))return!1;return!0});if(N){let u=figma.createFrame();u.resize(r,i),u.layoutMode="VERTICAL",u.primaryAxisAlignItems="CENTER",u.counterAxisAlignItems="CENTER",u.fills=[];let E=await b(o,N.properties);u.appendChild(E),p.appendChild(u)}else{let u=figma.createFrame();u.resize(r,i),u.fills=[],p.appendChild(u)}}n.appendChild(p)}return n}async function te(o){let t=figma.currentPage.selection.find(a=>a.type==="COMPONENT_SET");if(!t)throw new Error("No component set selected");let n={};for(let a of o)try{let r=await b(t,a.properties),i=await r.exportAsync({format:"PNG",constraint:{type:"SCALE",value:.5}}),l=figma.base64Encode(i);n[a.variantName]=l,r.remove()}catch(r){console.error("Error generating preview for",a.variantName,r)}return n}var k=O(()=>{"use strict";P()});var ne={"src/main.ts--default":(k(),q($)).default},re="src/main.ts--default";ne[re]();
